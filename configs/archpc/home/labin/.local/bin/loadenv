## Functions to load and unload environment variables from an .env file
# Load variable specified in .env file into the current shell
function loadenv() {
    set -o allexport
    [ "$#" -eq 1 ] && env="$1" || env=".env"
    [ -f "$env" ] && { echo "Env file $env exists, Sourcing..."; } || { return 1; }
    source <(
        cat "$env" |
            sed -e '/^#/d;/^\s*$/d' |
            sed -e "s/'/'\\\''/g" |
            sed -e "s/=\(.*\)/='\1'/g"
    ) && "$@"
    set +o allexport
}
loadenv
